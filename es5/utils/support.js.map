{"version":3,"file":"support.js","sourceRoot":"","sources":["../../lib/utils/support.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;GAEG;AACH,SAAS,SAAS;IAChB,OAAO,OAAO,eAAe,KAAK,WAAW,CAAC,CAAC,CAAC,IAAI,eAAe,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AAC/G,CAAC;AAQD;;;;;GAKG;AACH,SAAS,uBAAuB;IAC9B,IAAI,OAAO,MAAM,KAAK,WAAW,IAAI,OAAO,QAAQ,KAAK,WAAW,EAAE;QACpE,OAAO,IAAI,CAAC;KACb;IACD,IAAM,MAAM,GAAG,SAAS,EAAE,CAAC;IAC3B,IAAI,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAE;QAC/B,OAAO,QAAQ,CAAC;KACjB;IACD,IAAI,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;QAC3B,OAAO,IAAI,CAAC;KACb;IACD,OAAO,IAAI,CAAC;AACd,CAAC;AAED;;GAEG;AACH,SAAgB,kBAAkB;IAChC,wDAAwD;IACxD,OAAO,uBAAuB,EAAE,KAAK,IAAI,CAAC;AAC5C,CAAC;AAHD,gDAGC;AAED;;GAEG;AACH,SAAgB,qBAAqB;IACnC,OAAO,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC;WACpC,OAAO,iBAAiB,KAAK,UAAU,CAAC;AAC/C,CAAC;AAHD,sDAGC;AAED;;GAEG;AACU,QAAA,qBAAqB,GAAG,CAAC;IACpC,IAAM,UAAU,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;IAClC,IAAM,UAAU,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IAExC,IAAM,cAAc,GAAI,IAAI,SAAS,CAAC,IAAI,iBAAiB,mIACtD,UAAU,SAAK,UAAU,SAAK,UAAU,SACxC,UAAU,SAAK,UAAU,SAAK,UAAU,SACxC,UAAU,SAAK,UAAU,SAAK,UAAU,QAC3C,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAEV,IAAM,MAAM,GAAG,SAAS,EAAE,CAAC;IAC3B,IAAM,OAAO,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAA6B,CAAC;IAEpE,MAAM,CAAC,KAAK,GAAG,CAAC,CAAC;IACjB,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;IAClB,OAAO,CAAC,YAAY,CAAC,cAAc,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAC3C,OAAO,CAAC,MAAM,GAAG,WAAW,CAAC;IAC7B,OAAO,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAExB,IAAA,IAAI,GAAK,OAAO,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,KAArC,CAAsC;IAClD,OAAO,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;AACrB,CAAC,CAAC,EAAE,CAAC;AAEL;;;;;;;;;;;;;;GAcG;AACU,QAAA,WAAW,GAAG,kBAAkB,EAAE,CAAC","sourcesContent":["/**\n * @private\n */\nfunction getCanvas() {\n  return typeof OffscreenCanvas !== 'undefined' ? new OffscreenCanvas(1, 1) : document.createElement('canvas');\n}\n\n/**\n * Represents the identifier for the rendering context type.\n */\ntype RenderingContextType = '2d' | 'webgl2' | null;\n\n\n/**\n * @private\n * @returns {RenderingContextType} Determines the best available rendering context type.\n * Returns 'webgl2' if available, '2d' if available but webgl2 is not,\n * or null if neither context is available or if running in a non-browser environment.\n */\nfunction getRenderingContextType(): RenderingContextType {\n  if (typeof window === 'undefined' || typeof document === 'undefined') {\n    return null;\n  }\n  const canvas = getCanvas();\n  if (canvas.getContext('webgl2')) {\n    return 'webgl2';\n  }\n  if (canvas.getContext('2d')) {\n    return '2d';\n  }\n  return null;\n}\n\n/**\n * @private\n */\nexport function isBrowserSupported() {\n  // Check if any supported rendering context is available\n  return getRenderingContextType() !== null;\n}\n\n/**\n * @private\n */\nexport function isChromiumImageBitmap() {\n  return /Chrome/.test(navigator.userAgent)\n    && typeof createImageBitmap === 'function';\n}\n\n/**\n * @private\n */\nexport const isCanvasBlurSupported = (() => {\n  const blackPixel = [0, 0, 0, 255];\n  const whitePixel = [255, 255, 255, 255];\n\n  const inputImageData =  new ImageData(new Uint8ClampedArray([\n    ...blackPixel, ...blackPixel, ...blackPixel,\n    ...blackPixel, ...whitePixel, ...blackPixel,\n    ...blackPixel, ...blackPixel, ...blackPixel\n  ]), 3, 3);\n\n  const canvas = getCanvas();\n  const context = canvas.getContext('2d') as CanvasRenderingContext2D;\n\n  canvas.width = 3;\n  canvas.height = 3;\n  context.putImageData(inputImageData, 0, 0);\n  context.filter = 'blur(1px)';\n  context.drawImage(canvas, 0, 0);\n\n  const { data } = context.getImageData(0, 0, 3, 3);\n  return data[0] > 0;\n})();\n\n/**\n * Check if the current browser is officially supported by twilio-video-procesors.js.\n * This is set to `true` for browsers that supports canvas\n * [2D](https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D) or\n * [webgl2](https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext)\n * rendering context.\n * @example\n * ```ts\n * import { isSupported } from '@twilio/video-processors';\n *\n * if (isSupported) {\n *   // Initialize the background processors\n * }\n * ```\n */\nexport const isSupported = isBrowserSupported();\n"]}